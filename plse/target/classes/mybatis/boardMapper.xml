<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <!-- mapper 만드는 곳 -->
	<mapper namespace="com.care.mybatis.boardMapper">
	
	<!-- 게시글 리스트 -->
	<select id="board_list" resultType="Bdto">
		select * from board order by num desc
	</select>
	
	<!-- 게시글 작성 -->
	<insert id="board_reg" parameterType="Bdto">
		insert into board(num,title,nickname,hit,recommend,stars,productname,content,cvsnum) values(board_num_seq.nextval,#{title},#{nickname},0,0,#{stars},#{productname},#{content},#{cvsnum})
  	</insert>
  	
  	<!-- 게시글 클릭한것 보여주기 -->
  	<select id="board_view" resultType="Bdto">
  		select * from board where num=#{num}
  	</select>
  	
  	<!-- 게시글 조회수 증가 -->
  	<update id="upHit">
  		update board set hit=hit+1 where num=#{num}
  	</update>
  	<!-- 게시글 수정 -->
  	<update id="board_modify" parameterType="Bdto">
  		update board set cvsnum=#{cvsnum}, stars=#{stars}, title=#{title}, content=#{content} where num=#{num}
  	</update>
  	<!-- 게시글 삭제 -->
  	<delete id="board_delete">
  		delete from board where num=#{num}
  	</delete>
  	<!-- 게시글 검색 -->
  	<select id="board_search" parameterType="hashMap" resultType="Bdto" >
  		select * from board where #{search.searchSelect} like '%'||2||'%'
  	</select>
  	<!-- 가격 가져오기 -->
  	<select id="board_price" resultType="int">
  		select price from cvs where productname=#{productname}
  	</select>
  	<!-- 좋아요 -->
  	<insert id="board_heart" parameterType="Bdto">
		insert into heart values(#{num},#{nickname})
	</insert>
	<!-- 좋아요 취소 -->
	<delete id="board_unheart" parameterType="Bdto">
		delete from heart where bnum=#{num} and nickname=#{nickname}
	</delete>
	<!-- 좋아요 여부 체크 -->
	<select id="board_heartChk" parameterType="Bdto" resultType="int">
		select * from heart where bnum=#{num} and nickname=#{nickname}
	</select>
	<!-- 게시판별 좋아요 개수 -->
	<select id="board_heartCnt" resultType="int">
		select count(*) from heart where bnum=#{bnum}
	</select>
	</mapper>